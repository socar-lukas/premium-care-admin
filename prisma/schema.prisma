// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Vehicle {
  id            String        @id @default(uuid())
  vehicleNumber String        @unique
  ownerName     String
  model         String?
  manufacturer  String?
  year          Int?
  contact       String?
  vehicleType   String?
  engine        String?       // 엔진 타입
  fuel          String?       // 연료 타입
  memo          String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  inspections   Inspection[]

  @@index([vehicleNumber])
  @@index([ownerName])
  @@map("Vehicle")
}

model Inspection {
  id              String            @id @default(uuid())
  vehicleId       String
  vehicle         Vehicle           @relation(fields: [vehicleId], references: [id], onDelete: Cascade)
  inspectionDate  DateTime
  completedAt     DateTime?         // 점검 완료 시각
  inspectionType  String            // 세차전, 세차후, 정기점검, 수리 등
  overallStatus   String            // 우수, 양호, 보통, 불량
  inspector       String?
  memo            String?
  details         Json?             // 세차점검 상세 데이터 (오염도, 타이어, 조치 등)
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  areas           InspectionArea[]

  @@index([vehicleId])
  @@index([inspectionDate])
  @@map("Inspection")
}

model InspectionArea {
  id            String            @id @default(uuid())
  inspectionId  String
  inspection    Inspection        @relation(fields: [inspectionId], references: [id], onDelete: Cascade)
  areaCategory  String            // 외부, 내부, 엔진실, 타이어, 기타
  areaName      String
  status        String            // 우수, 양호, 보통, 불량, 수리필요
  memo          String?
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
  photos        InspectionPhoto[]

  @@index([inspectionId])
  @@map("InspectionArea")
}

model InspectionPhoto {
  id                String          @id @default(uuid())
  inspectionAreaId  String
  inspectionArea    InspectionArea  @relation(fields: [inspectionAreaId], references: [id], onDelete: Cascade)
  fileName          String
  originalFileName  String
  filePath          String
  googleDriveFileId String?
  googleDriveUrl    String?
  fileSize          Int
  mimeType          String
  description       String?
  uploadedAt        DateTime        @default(now())

  @@index([inspectionAreaId])
  @@map("InspectionPhoto")
}


